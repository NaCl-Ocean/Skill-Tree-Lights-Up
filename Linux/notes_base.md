# linux 基础

- **linux 文件目录**

  - 只有一个根目录，根目录下存在不同的目录，不存在windows下的c盘，D盘等分区。

  - 级层式的树状目录结构，最上层的是根目录，同时各目录存放的内容都是具体含义的。

  - **Linux世界里，一切皆为文件**

    ![img](https://www.runoob.com/wp-content/uploads/2014/06/003vPl7Rty6E8kZRlAEdc690.jpg)

    

- shell terminal的区别

  - shell 负责与kernel（也就是linux内核）交互，terminal 接收用户的输入，交给shell，shell解析后交给系统内核，执行结果返回给terminal，terminal显示结果。

- 远程操控

  - x shell   ssh 协议，linux机器开启sshd服务，默认端口22，主机地址为ifconfig命令输出的ip 地址。
  - Xftp 传输文件

# vi vim 使用

- vi 文本编辑器  vim  程序编辑
- 三种常见模式
  - 正常模式：可以使用快捷键
  - 插入模式/编辑模式：可以输入内容，按下 i, I, o, O, a, A, r, R 等任何一个字母之后才会进入编辑模式, 一般来说按 i 即可
  - 命令行模式：提供相关指令
  - <img src="http://image.haiyang1218.cn/images/linux_vim.png" width="500px" />
- 快捷键
  - yy 复制当前行 5yy 复制当前向下的5行
  - dd 删除当前行 5dd删除当前向下的5行
  - p 粘贴
  - 文件中查找内容 进入命令行模式，输入 /查找内容 ，之后回车。输入n查找下一个查询。
  - 设置文件的行号 命令行模式，输入 :set nu
  - 取消文件的行号 命令行模式，输入 :set nonu
  - G 到达文件的最末行（正常模式）
  - gg 到达文件的首行（正常模式）
  - u 撤销文件输入（正常模式）

# 开关机、用户登录与注销

- 关机&重启
  - shutdown -h now 立即关机
  - shutdown -h 1 一分钟后关机
  - shutdown -r now 立即重启
  - sync 将内存数据写入磁盘（关机或重启前使用）
  - reboot 重启系统
- 用户登录&注销
  - 使用普通用户登录后，使用su - 用户名 切换成系统管理员
  - logout 注销用户（运行级别 3 下有效）

# 用户管理

- 用户登录时，自动进入该用户的家目录，未指定的情况下，位于/home下
- 每个用户至少属于一个用户组
- **useradd** [选项] [用户名]
  - useradd [用户名]  自动创建和该用户相对应的用户组，并将该用户加入到该用户组
  - useradd -d [目录] [用户名] 指定该用户的家目录
  - useradd -g [用户组] [用户名]：指定该用户的用户组
- **passwd** [用户名] ：指定该用户的密码
- **userdel** [用户名]：删除该用户
  - userdel [用户名] ：保留用户的家目录
  - userdel -r [用户名]： 删除用户的家目录
- **id** [用户名] ：查询用户信息
- **su** - [用户名]：切换用户
  - 低权限用户切换到高权限用户：
    - exit 回退到原来的用户（前提是从高权限用户进入到低权限用户，可以利用次命令回退到原来的高权限用户）
    - 直接利用su - [用户名]：需要输入密码
- who am i 查看当前用户
- 用户组：有共性的用户进行统一管理
  - **groupadd** [组名]： 增加组
  - **groupdel** [组名]：删除组
  - **usermod** **-g** [用户组] [用户名]：修改用户的组

- 配置文件
  - 用户配置文件 /etc/passwd，包括用户名，口令，用户id，组id，家目录，使用的shell
  - 用户组配置文件 /etc/group，包括组名，口令，组id，组内用户列表
  - 口令(密码)配置文件 /etc/shadow

# 实用指令

## 指定运行级别

- 运行级别

     	0.关机

  1. 单用户[找回丢失密码]
  2. 多用户无网络服务
  3. 多用户有网络
  4. 保留
  5. 图形界面
  6. 重启

- 运行级别配置文件 /etc/inittab，可在该文件中指定运行级别
- init [0/1/2/3/5/6]： 切换到指定运行级别
- 当远程登陆时，处于运行级别3

## 帮助指令

- man [命令或配置文件] 

- help [命令]

## 文件目录类

- **pwd** 显示当前工作目录的绝对路径 present working directory
- **ls** [选项] [目录/文件]  ：列出目录下的所有文件，当不指定目录时，默认为当前目录
  - -a 显示当前目录所有文件和目录，包括隐藏
  - -l 以列表的方式显示信息
  - -h 以人易读的方式显示信息
- **cd** [目录]
  - cd ~ 切换到家目录
  - cd .. 切换到上一级目录
  - "/" 表示根目录，以"/" 开头表示的是绝对地址

- **mkdir** [选项] [要创建的目录]
  - mkdir -p [目录] ：创建多级目录
- **rmdir** [选项] [要删除的目录]：删除目录
  - 无法删除非空目录
  - rm -rf [要删除的目录]：可用于删除非空目录
- **touch** [文件名]：创建空文件，也可用于一次性创建多个空文件
- **cp** [选项] source dest
  - -r 递归复制整个文件夹
  - 注意：source dest 如果是目录，“/”不可省略
  - \cp 强制覆盖
- **rm** [选项] [要删除的文件或者目录]：删除文件或者目录
  - -r 递归删除整个文件夹
- **mv** source dest：移动文件或者目录
  - 可用于重命名 
  - 移动文件夹下的内容 mv 目录/* dest
- **cat** [选项] [要查看的文件] ：查看文件内容
  - 只读
  - -n 显示行号
  - cat [选项] [要查看的文件]  |more : 分页查看文件内容
- **more** [要查看的文件]：以全屏方式按页显示文本
- **less** [要查看的文件]：同样是分屏按页显示文本，对于显示大型文件具有较高的效率
- **\>**  [文件] 输出重定向 ：加在其他指令之后，表示将terminal输出的内容写入某个文件
  - 若原文件中有内容，会覆盖原文件
- **\>\>** [文件] 追加
  - 若原文件存在，不会覆盖原文件
- **echo**  [选项] [输出内容]  输出内容到terminal
  - `echo "hello" `：terminal 输出hello
- **head** [文件]：显示文件的开头部分，默认显示10行
  - head -n 5 [文件]：查看文件开头的5行
- **tail** [文件]：显示文件的末尾部分，默认显示10行
  - tail -n 5 [文件]：文件末尾的5行
  - tail -f [文件]： 实时追踪  ctrl+c 退出
- **ln -s** [原文件/目录] [软链接名]：创建软链接
  - 删除软链接 rm -rf [软链接名]
  - 使用pwd 查看软链接的地址，显示的是软链接的地址，而不是原文件的地址

## 时间日期类

- **date** 显示当前时间
  - date “+%Y” 显示年份
  - date "+%Y-%m-%d" 连接符可以任意 “+"不可省略
  - dare "+%Y-%m-%d %H-%M-%S" 显示年月日 时分秒
  - date -s [字符串时间] 设置当前时间

## 搜索查找类

- **find** [搜索范围] [选项]
  - -name [查找文件名] 按照文件名查找文件
  - -user [用户名] 按照文件的拥有者查找文件
  - -size [+n/n/-n] 按照大于n/等于n/小于n查找文件 （n为文件大小）
  - 可以使用通配符
- **locate** [搜索文件] 定位文件路径
  - 需要先使用**updatedb** 创建locate文件数据库
- **grep** [选项] [查找内容] [源文件] ：过滤查找
  - -n 显示匹配及行号
  - -i 忽略大小写
  - `cat hello.txt | grep -n yes` :查找hello.txt中yes所在行
  - *通常可用于管道操作，用于过滤*

## 压缩和解压

- **gzip / gunzip**

  - 使用gzip压缩文件后，原文件不存在

- **zip/unzip**

  - zip [选项] [xxx.zip] [要压缩的文件] ：-r 递归压缩
  - unzip [选项] [xxx.zip] ：-d [目录] 指定解压后文件的存放目录

- **tar** [选项] [xxx.tar.gz] [要打包的文件]

  - 最终打包后的文件是.tar.gz的文件

    - |  选项  |  含义  |
      | :--: | :----------------: |
      |  -v  |    显示详细信息    |
      |  -f  | 指定压缩后的文件名 |
      |  -z  |    打包同时压缩    |
      |     -x      |         解包.tar 文件     |
      |-c|产生.tar打包文件|

  - 一般同时使用-zcvf 压缩文件，使用-zxvf解压缩文件

  -  指定解压缩到某个目录：tar [-zxvf] [xxx.tar.gz] -C [解压缩目录]

    - 解压缩目录需要存在

## 文件的组管理和权限管理

- 文件/目录的所有者、用户组
  - 当某个用户创建文件后，该文件所在组默认为用户所在的组
  - ls 指令即可查看文件的所有者以及所在组
  - **chown** [用户] [文件] ：修改文件的所有者，但是不会修改所在组
    - chown [用户：用户组] [文件] ：同时修改所有者以及所在组 
    - -R 递归修改目录下的所有文件以及子目录
  - **chgrp** [组名] [文件] ：修改文件的所在组，不会修改文件的所有者
    - -R 递归修改目录下的所有文件以及子目录
  - 其他组：除文件的所有者和所在组的用户外，系统的其它用户都是文件的其它组
  - 改变用户所在的组，不会改变该用户下文件的所在组
  
- 权限基本介绍

  - 文件类型：- 普通文件，d：目录，l：软链接，c：字符设备[键盘，鼠标]，b：块文件
- ls -l 显示内容解读：`-rwxrw-r-- 1 root root 1213 Feb 2 09:39 abc`

| 位数 |                          含义                           |
| :--: | :-----------------------------------------------------: |
|  0   |                        文件类型                         |
| 1-3  |                    文件所有者的权限                     |
| 4-6  |                  文件所在组用户的权限                   |
| 7-9  |                      其他组的权限                       |
|  10  | 若是文件为1，表示硬链接，若是目录表示目录下子目录的个数 |

| 权限 |              作用于目录              |               作用于文件                |
| :--: | :----------------------------------: | :-------------------------------------: |
|  r   |    可以读取，使用ls查看该目录内容    |             可以读取，查看              |
|  w   | 可以修改，创建，删除文件，重命名目录 | 可以修改，不可删除，除非所在目录有w权限 |
|  x   |             可以进入目录             |                可以执行                 |

- 权限修改
  - **chmod** 变更权限：+ - = ， u：所有者，g：所在组，o：其他人，a：所有人 
    - 例：`chmod u=rwx,g=rw,o=r test.txt` test.txt的所有者权限为rxw，所在组权限为rw，其他组权限为r
    - 使用数字：r=4，w=2，x=1，`chmod  751 test.txt` 相当于修改权限为u:rwx，g:r-x，o:r-x

## 任务调度

- **crontab** [选项]：定时任务

  - -e 编辑定时调度任务

  - -l 查询定时调度任务

  - -r 删除当前用户的所有定时任务

  - 简单任务不用写脚本，直接通过`crontab -e`输入任务

  - 参数说明

    | 特殊符号 |                             含义                             |
    | :------: | :----------------------------------------------------------: |
    |    *     | 代表任何时间。比如第一个*"就代表-小时中每分钟都执行一次的意思。 |
    |    ,     | 代表不连续的时间。比如`0 8,12,16 * * *`就代表在每天的8点o分，12点0分，16点0分都执行一次命令 |
    |    -     | 代表连续的时间范围。比如`0 5 * * 1-6`代表在周一到周六的凌晨5点0分执行命令 |
    |   */n    | 代表每隔多久执行一次。比如`*/10 * * * * `代表每隔10分钟就执行一遍命令 |

  |   项目    |         含义         | 范围 |
  | :-------: | :------------------: | :--: |
  | 第一个”*“ | 一小时当中的第几分钟 | 0-59 |
  | 第二个”*“ |  一天当中的第几小时  | 0-24 |
  | 第三个”*“ |  一个月当中的第几天  | 1-31 |
  | 第四个”*“ |   一年当中的第几月   | 1-12 |
  | 第五个”*“ |   一周当中的星期几   | 1-7  |

## 磁盘分区

- linux 分区通过挂载mount，将一个分区和一个目录联系起来
- 硬盘说明：
  - 对于IDE硬盘，驱动器标识符为“hdx~"其中“hd"表明分区所在设备的类型，这里是指IDE 硬盘。“x"为盘号(a为基本盘，b为基本从属盘，c为辅助主盘，d为辅助从属盘)。“~”代表分区,前四个分区用数字1到4表示，它们是主分区或扩展分区，从5开始就是逻辑分区。例，hda3 表示为第一个IDE硬盘上的第三个主分区或扩展分区,hdb2表示为第二个IDE硬盘上的第二个主分区或扩展分区。
  - 对于SCSI 硬盘则标识为“sdx~”，SCSI硬盘是用“d"来表示分区所在设备的类型的，其余则和IDE硬盘的表示方法一样。
- **lsblk -f / lsblk** 查看系统分区与挂载情况
- 增加一块硬盘
  - 分区
  - 格式化
  - 挂载：mount 设备名称 挂载目录
  - 设置自动挂载（永久挂载）
- df -lh：磁盘情况查询
- du [选项] [目录]
  -  -h
  - -s 指定目录占用大小汇总
  - -a 含文件
  - --max-depth=1 子目录深度
  - -c 列出明细的同时，增加汇总值
- 统计文件的个数：`ls -l [目录] | grep "^-" |wc -l`
- 统计文件夹的个数 ``ls -l [目录] | grep "^d" |wc -l`

## 进程管理

- linux下每个进程都有一个ID。
- 进程分为前台与后台。系统的服务一般以后台的方式存在。
- **ps** 显示系统执行的进程
  - -a ：显示当前终端的所有进程信息
  - -u：以用户的格式显示进程信息
  - -x ：显示后台进程运行的参数
  - -ef：全格式查看父进程
  - PID：进程ID  TTY：使用的终端  STAT：进程的状态（s：休眠，r：运行）
  - vsz：占用的虚拟内存大小 RSS：占用的物理内存大小
  - 查看具体某个进程：`ps -aux | grep xxx`
- **kill** [选项] [进程ID]
  - 一般先通过ps 查找到具体的PID，之后通过PID杀死进程
- **killall** [选项] [进程名称]：支持通配符
  - -9 强制杀死进程
  - 和kill的区别是 通过进程的名称来杀死进程。相当于结合了ps+kill
- **pstree** 以树桩形式查看进程信息
  - -p：显示进程的PID
  - -u：显示进程的所属用户

## 服务（service）

- 运行在后台，监听程序响应，守护进程，如防火墙，SSHD等

- **service** [服务名] [start|stop|restart|reload|status]：管理服务
  - 临时生效，重启系统后，失效
- telnet ip [端口]：查找某个端口是否开启且可以访问
- 查看系统的服务：setup -> 系统服务 or `ls -l /etc/init.d/`
  - space 键开启或者关闭某个服务
  - tab 键切换到确定或者取消  ，enter退出
- 运行级别：即为前面提到的7个运行级别
  - 设置运行级别即为设置在该运行级别下是否自启动或者关闭
  - `chkconfig --list | grep xxx` or `chkconfig 服务名 --list` 查看某个服务各运行级别自启动/关闭
  - `chkconfig --level 5 服务名 on/off` 设置服务在级别5下自启动or关闭
  - `chkconfig 服务名 on/off`  设置服务在所有运行级别下自启动/关闭
- **top** [选项]： 动态监控进程
  - 与ps的不同之处在于可以在一段时间后更新进程的状态
  - -d 秒数 指定top命令每隔几秒更新
  - -i 不显示闲置和僵死进程
  - -p 指定监控进程id来仅仅监控某个进程
  -  监视特定用户的进程：进入top后，输入”u"，之后输入用户名 
  - 终止指定的进程：进入top后，输入"k"，之后输入要杀死进程的PID

## 网络

- **netstat** [选项] ：查看系统网络情况
  - -an ：按一定顺序排列输出
  - -p ：显示哪个进程在使用

## RPM包管理

- RedHat Package Manager 
- rpm 包管理查询：-q
  - `rpm -qa | grep xxx` or `rpm -q xxx`：查询系统中是否装有该软件
  - -a ：查看系统安装的所有软件
  - 输出包括：软件名、软件版本、适用于的操作系统以及64/32位
  - -i 查询安装的rpm包软件信息
  - -l 查询rpm软件包安装到了哪里
  - -f 查询文件属于哪个软件包
- rpm 包管理卸载：-e
  - 若其他软件包依赖于要卸载的包，卸载时会产生错误信息
  - `rpm -e -nodeps xxx`：强制卸载
- rpm 包管理安装：-ivh(i-install v-verbose h-hash进度条）
  - 需要先下载rpm包，之后进行安装
- yum包管理
  - 类似于pip，可以自动从服务器请求下载rpm包并安装，自动处理依赖关系
  - `yum list`：查询安装的所有软件
  - `yum install xxx`：安装指定的yum包

## 其他

- 使用上下箭头调出曾经使用过的命令，history 显示之前使用过的所用命令
- **history** 查看历史命令/执行历史命令
  - history 10 查看最近执行的10个命令
  - !178 执行编号为178的历史命令
- **| 管道操作**
  - 将前一个命令输出的内容传递给下一个命令
- **clear** 清除终端的命令

 

# 参考

[vi vim 快捷键](https://www.runoob.com/linux/linux-vim.html)

[linux系统目录结构](https://www.runoob.com/linux/linux-system-contents.html)

[网课地址](https://www.bilibili.com/video/BV1dW411M7xL?p=29)



